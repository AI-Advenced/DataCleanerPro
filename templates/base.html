<!DOCTYPE html>
<html lang="fr" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block meta_description %}DataCleaner-Pro - Application Flask professionnelle de nettoyage et d'analyse de données avec IA intégrée{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}data cleaning, analyse de données, machine learning, ETL, python, flask, IA{% endblock %}">
    <meta name="author" content="DataCleaner-Pro Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}DataCleaner-Pro - Nettoyage et Analyse de Données{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Plateforme avancée de nettoyage automatique et d'analyse de données avec intelligence artificielle{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:image" content="{{ url_for('static', filename='images/datacleaner-og.png') }}">
    <meta property="og:site_name" content="DataCleaner-Pro">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}DataCleaner-Pro{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Plateforme avancée de nettoyage et d'analyse de données{% endblock %}">
    <meta name="twitter:image" content="{{ url_for('static', filename='images/datacleaner-twitter.png') }}">
    
    <title>{% block title %}DataCleaner-Pro{% endblock %}</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='images/apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='images/favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='images/favicon-16x16.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">
    
    <!-- CSS Dependencies -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/datatables.net-bs5@1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3.10.0/notyf.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css">
    
    <!-- Custom Styles -->
    <style>
        :root {
            --dc-primary: #2563eb;
            --dc-primary-dark: #1d4ed8;
            --dc-primary-light: #3b82f6;
            --dc-secondary: #64748b;
            --dc-success: #10b981;
            --dc-danger: #ef4444;
            --dc-warning: #f59e0b;
            --dc-info: #06b6d4;
            --dc-light: #f8fafc;
            --dc-dark: #0f172a;
            --dc-muted: #64748b;
            --dc-border: #e2e8f0;
            --dc-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --dc-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --dc-gradient: linear-gradient(135deg, var(--dc-primary) 0%, var(--dc-primary-light) 100%);
            --dc-font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --dc-border-radius: 0.75rem;
            --dc-transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        [data-bs-theme="dark"] {
            --dc-light: #1e293b;
            --dc-dark: #f1f5f9;
            --dc-border: #334155;
            --dc-muted: #94a3b8;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--dc-font-family);
            line-height: 1.6;
            color: var(--dc-dark);
            background-color: var(--dc-light);
            transition: var(--dc-transition);
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--dc-light);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--dc-muted);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--dc-secondary);
        }
        
        /* Navigation Styles */
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--dc-border);
            box-shadow: var(--dc-shadow);
            transition: var(--dc-transition);
        }
        
        [data-bs-theme="dark"] .navbar {
            background: rgba(30, 41, 59, 0.95) !important;
        }
        
        .navbar-brand {
            font-weight: 800;
            font-size: 1.5rem;
            color: var(--dc-primary) !important;
            text-decoration: none;
            transition: var(--dc-transition);
        }
        
        .navbar-brand:hover {
            transform: scale(1.05);
        }
        
        .navbar-brand i {
            margin-right: 0.5rem;
            font-size: 1.75rem;
        }
        
        .navbar-nav .nav-link {
            font-weight: 500;
            color: var(--dc-secondary) !important;
            padding: 0.75rem 1rem !important;
            border-radius: var(--dc-border-radius);
            transition: var(--dc-transition);
            margin: 0 0.25rem;
        }
        
        .navbar-nav .nav-link:hover,
        .navbar-nav .nav-link.active {
            color: var(--dc-primary) !important;
            background-color: rgba(37, 99, 235, 0.1);
            transform: translateY(-1px);
        }
        
        .navbar-nav .nav-link i {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }
        
        /* Dropdown Menus */
        .dropdown-menu {
            border: none;
            box-shadow: var(--dc-shadow-lg);
            border-radius: var(--dc-border-radius);
            padding: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .dropdown-item {
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            font-weight: 500;
            transition: var(--dc-transition);
        }
        
        .dropdown-item:hover {
            background-color: var(--dc-primary);
            color: white;
            transform: translateX(4px);
        }
        
        .dropdown-item i {
            margin-right: 0.75rem;
            width: 1.25rem;
            text-align: center;
        }
        
        /* User Avatar */
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--dc-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            margin-right: 0.5rem;
        }
        
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 76px;
            left: 0;
            height: calc(100vh - 76px);
            width: 280px;
            background: white;
            border-right: 1px solid var(--dc-border);
            padding: 1.5rem 0;
            overflow-y: auto;
            transition: var(--dc-transition);
            z-index: 1000;
        }
        
        [data-bs-theme="dark"] .sidebar {
            background: var(--dc-light);
        }
        
        .sidebar.collapsed {
            width: 80px;
        }
        
        .sidebar-nav {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-nav-item {
            margin: 0.25rem 1rem;
        }
        
        .sidebar-nav-link {
            display: flex;
            align-items: center;
            padding: 0.875rem 1rem;
            color: var(--dc-secondary);
            text-decoration: none;
            border-radius: var(--dc-border-radius);
            transition: var(--dc-transition);
            font-weight: 500;
        }
        
        .sidebar-nav-link:hover,
        .sidebar-nav-link.active {
            color: var(--dc-primary);
            background-color: rgba(37, 99, 235, 0.1);
            transform: translateX(4px);
        }
        
        .sidebar-nav-link i {
            margin-right: 0.75rem;
            font-size: 1.25rem;
            width: 1.5rem;
            text-align: center;
        }
        
        .sidebar.collapsed .sidebar-nav-link span {
            display: none;
        }
        
        .sidebar-section {
            margin: 2rem 0 1rem;
            padding: 0 2rem;
        }
        
        .sidebar-section-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--dc-muted);
            margin-bottom: 0.5rem;
        }
        
        .sidebar.collapsed .sidebar-section {
            display: none;
        }
        
        /* Main Content */
        .main-content {
            margin-left: 280px;
            min-height: calc(100vh - 76px);
            padding: 2rem;
            transition: var(--dc-transition);
        }
        
        .main-content.expanded {
            margin-left: 80px;
        }
        
        @media (max-width: 991.98px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.show {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
        }
        
        /* Cards */
        .card {
            border: none;
            border-radius: var(--dc-border-radius);
            box-shadow: var(--dc-shadow);
            transition: var(--dc-transition);
        }
        
        .card:hover {
            box-shadow: var(--dc-shadow-lg);
            transform: translateY(-2px);
        }
        
        .card-header {
            background: transparent;
            border-bottom: 1px solid var(--dc-border);
            padding: 1.5rem;
            font-weight: 600;
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        /* Buttons */
        .btn {
            font-weight: 600;
            border-radius: var(--dc-border-radius);
            padding: 0.75rem 1.5rem;
            transition: var(--dc-transition);
            border: none;
            text-transform: none;
            letter-spacing: 0;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--dc-shadow-lg);
        }
        
        .btn-primary {
            background: var(--dc-gradient);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--dc-primary-dark) 0%, var(--dc-primary) 100%);
            color: white;
        }
        
        .btn-outline-primary {
            border: 2px solid var(--dc-primary);
            color: var(--dc-primary);
        }
        
        .btn-outline-primary:hover {
            background: var(--dc-primary);
            color: white;
        }
        
        .btn-lg {
            padding: 1rem 2rem;
            font-size: 1.1rem;
        }
        
        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        /* Forms */
        .form-control,
        .form-select {
            border: 2px solid var(--dc-border);
            border-radius: var(--dc-border-radius);
            padding: 0.75rem 1rem;
            font-weight: 500;
            transition: var(--dc-transition);
        }
        
        .form-control:focus,
        .form-select:focus {
            border-color: var(--dc-primary);
            box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
        }
        
        .form-label {
            font-weight: 600;
            color: var(--dc-dark);
            margin-bottom: 0.5rem;
        }
        
        .form-check-input:checked {
            background-color: var(--dc-primary);
            border-color: var(--dc-primary);
        }
        
        /* Alerts */
        .alert {
            border: none;
            border-radius: var(--dc-border-radius);
            padding: 1rem 1.5rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
        }
        
        .alert-success {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--dc-success);
            border-left: 4px solid var(--dc-success);
        }
        
        .alert-danger {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--dc-danger);
            border-left: 4px solid var(--dc-danger);
        }
        
        .alert-warning {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--dc-warning);
            border-left: 4px solid var(--dc-warning);
        }
        
        .alert-info {
            background-color: rgba(6, 182, 212, 0.1);
            color: var(--dc-info);
            border-left: 4px solid var(--dc-info);
        }
        
        /* Tables */
        .table {
            font-weight: 500;
        }
        
        .table th {
            border-top: none;
            border-bottom: 2px solid var(--dc-border);
            color: var(--dc-dark);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            padding: 1rem 0.75rem;
        }
        
        .table td {
            padding: 1rem 0.75rem;
            border-top: 1px solid var(--dc-border);
            vertical-align: middle;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(37, 99, 235, 0.05);
        }
        
        /* Badges */
        .badge {
            font-weight: 600;
            padding: 0.5rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.75rem;
        }
        
        .badge-success {
            background-color: var(--dc-success);
            color: white;
        }
        
        .badge-danger {
            background-color: var(--dc-danger);
            color: white;
        }
        
        .badge-warning {
            background-color: var(--dc-warning);
            color: white;
        }
        
        .badge-info {
            background-color: var(--dc-info);
            color: white;
        }
        
        /* Progress Bars */
        .progress {
            height: 0.75rem;
            border-radius: 2rem;
            background-color: var(--dc-border);
        }
        
        .progress-bar {
            background: var(--dc-gradient);
            border-radius: 2rem;
            transition: width 0.6s ease;
        }
        
        /* Stats Cards */
        .stat-card {
            background: white;
            border-radius: var(--dc-border-radius);
            padding: 2rem;
            box-shadow: var(--dc-shadow);
            transition: var(--dc-transition);
            border-left: 4px solid var(--dc-primary);
        }
        
        .stat-card:hover {
            box-shadow: var(--dc-shadow-lg);
            transform: translateY(-2px);
        }
        
        .stat-card-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: var(--dc-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .stat-card-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--dc-dark);
            line-height: 1;
            margin-bottom: 0.5rem;
        }
        
        .stat-card-label {
            color: var(--dc-muted);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
        }
        
        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }
        
        /* Modal Styles */
        .modal-content {
            border: none;
            border-radius: var(--dc-border-radius);
            box-shadow: var(--dc-shadow-lg);
        }
        
        .modal-header {
            border-bottom: 1px solid var(--dc-border);
            padding: 1.5rem;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-footer {
            border-top: 1px solid var(--dc-border);
            padding: 1.5rem;
        }
        
        /* File Upload */
        .file-upload-area {
            border: 2px dashed var(--dc-border);
            border-radius: var(--dc-border-radius);
            padding: 3rem 2rem;
            text-align: center;
            transition: var(--dc-transition);
            cursor: pointer;
        }
        
        .file-upload-area:hover,
        .file-upload-area.dragover {
            border-color: var(--dc-primary);
            background-color: rgba(37, 99, 235, 0.05);
        }
        
        .file-upload-icon {
            font-size: 3rem;
            color: var(--dc-muted);
            margin-bottom: 1rem;
        }
        
        /* Chart Containers */
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        
        /* Footer */
        .footer {
            background: var(--dc-dark);
            color: white;
            padding: 3rem 0 2rem;
            margin-top: 4rem;
        }
        
        [data-bs-theme="dark"] .footer {
            background: #0f172a;
        }
        
        .footer h5 {
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .footer a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--dc-transition);
        }
        
        .footer a:hover {
            color: white;
            transform: translateX(2px);
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 2rem;
            margin-top: 2rem;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* Theme Toggle */
        .theme-toggle {
            background: none;
            border: 2px solid var(--dc-border);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dc-secondary);
            transition: var(--dc-transition);
            cursor: pointer;
        }
        
        .theme-toggle:hover {
            border-color: var(--dc-primary);
            color: var(--dc-primary);
            transform: scale(1.1);
        }
        
        /* Utilities */
        .text-gradient {
            background: var(--dc-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .bg-gradient {
            background: var(--dc-gradient);
        }
        
        .shadow-custom {
            box-shadow: var(--dc-shadow);
        }
        
        .shadow-lg-custom {
            box-shadow: var(--dc-shadow-lg);
        }
        
        .rounded-custom {
            border-radius: var(--dc-border-radius);
        }
        
        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        .scale-in {
            animation: scaleIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .stat-card {
                padding: 1.5rem;
            }
            
            .stat-card-value {
                font-size: 2rem;
            }
            
            .navbar-brand {
                font-size: 1.25rem;
            }
            
            .navbar-brand i {
                font-size: 1.5rem;
            }
        }
        
        /* Print Styles */
        @media print {
            .navbar,
            .sidebar,
            .footer {
                display: none !important;
            }
            
            .main-content {
                margin-left: 0 !important;
                padding: 0 !important;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
        }
        
        /* High Contrast Mode Support */
        @media (prefers-contrast: high) {
            :root {
                --dc-border: #000;
                --dc-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            }
        }
        
        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Focus Management */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--dc-primary);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 10000;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* Additional Component Styles */
        .breadcrumb {
            background: none;
            padding: 0;
            margin-bottom: 1.5rem;
        }
        
        .breadcrumb-item + .breadcrumb-item::before {
            content: "›";
            color: var(--dc-muted);
        }
        
        .breadcrumb-item.active {
            color: var(--dc-dark);
            font-weight: 600;
        }
        
        .pagination .page-link {
            border: none;
            border-radius: var(--dc-border-radius);
            margin: 0 0.25rem;
            color: var(--dc-secondary);
            font-weight: 500;
            transition: var(--dc-transition);
        }
        
        .pagination .page-link:hover,
        .pagination .page-item.active .page-link {
            background-color: var(--dc-primary);
            color: white;
            transform: translateY(-1px);
        }
        
        /* Code Blocks */
        pre {
            background: var(--dc-light);
            border: 1px solid var(--dc-border);
            border-radius: var(--dc-border-radius);
            padding: 1rem;
            overflow-x: auto;
        }
        
        code {
            background: rgba(37, 99, 235, 0.1);
            color: var(--dc-primary);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
        }
        
        /* Tooltip Customization */
        .tooltip .tooltip-inner {
            background: var(--dc-dark);
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            font-weight: 500;
        }
        
        /* Custom Select2 Styling */
        .select2-container--default .select2-selection--single {
            height: auto;
            border: 2px solid var(--dc-border);
            border-radius: var(--dc-border-radius);
            padding: 0.5rem 0.75rem;
        }
        
        .select2-container--default.select2-container--focus .select2-selection--single {
            border-color: var(--dc-primary);
        }
        
        /* DataTables Customization */
        .dataTables_wrapper .dataTables_filter input {
            border: 2px solid var(--dc-border);
            border-radius: var(--dc-border-radius);
            padding: 0.5rem 0.75rem;
            margin-left: 0.5rem;
        }
        
        .dataTables_wrapper .dataTables_length select {
            border: 2px solid var(--dc-border);
            border-radius: var(--dc-border-radius);
            padding: 0.25rem 0.5rem;
        }
        
        /* Custom Checkbox and Radio */
        .form-check-input[type="checkbox"] {
            border-radius: 0.375rem;
        }
        
        .form-check-input[type="radio"] {
            border-radius: 50%;
        }
        
        /* Advanced Form Styles */
        .input-group .form-control:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        .input-group .form-control:not(:first-child) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }
        
        .input-group-text {
            background-color: var(--dc-light);
            border: 2px solid var(--dc-border);
            border-right: none;
            color: var(--dc-secondary);
            font-weight: 500;
        }
        
        /* Status Indicators */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.5rem;
        }
        
        .status-dot.success {
            background-color: var(--dc-success);
        }
        
        .status-dot.danger {
            background-color: var(--dc-danger);
        }
        
        .status-dot.warning {
            background-color: var(--dc-warning);
        }
        
        .status-dot.info {
            background-color: var(--dc-info);
        }
        
        /* Timeline Styles */
        .timeline {
            position: relative;
            padding-left: 2rem;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--dc-border);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -1.75rem;
            top: 0.25rem;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--dc-primary);
        }
        
        /* Card Deck Improvements */
        .card-deck .card {
            flex: 1 1 0px;
            margin-bottom: 1.5rem;
        }
        
        @media (min-width: 576px) {
            .card-deck {
                display: flex;
                flex-flow: row wrap;
                margin-right: -0.75rem;
                margin-left: -0.75rem;
            }
            
            .card-deck .card {
                margin-right: 0.75rem;
                margin-left: 0.75rem;
                margin-bottom: 0;
            }
        }
        
        /* Advanced Animation Support */
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% {
                color: rgba(0,0,0,0);
                text-shadow: .25em 0 0 rgba(0,0,0,0), .5em 0 0 rgba(0,0,0,0);
            }
            40% {
                color: var(--dc-primary);
                text-shadow: .25em 0 0 rgba(0,0,0,0), .5em 0 0 rgba(0,0,0,0);
            }
            60% {
                text-shadow: .25em 0 0 var(--dc-primary), .5em 0 0 rgba(0,0,0,0);
            }
            80%, 100% {
                text-shadow: .25em 0 0 var(--dc-primary), .5em 0 0 var(--dc-primary);
            }
        }
    </style>
    
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Skip to main content link for accessibility -->
    <a class="skip-link" href="#main-content">Aller au contenu principal</a>
    
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container-fluid">
            <!-- Brand -->
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="bi bi-database-fill-gear"></i>
                DataCleaner-Pro
            </a>
            
            <!-- Mobile Menu Toggle -->
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <i class="bi bi-list fs-4"></i>
            </button>
            
            <!-- Navigation Items -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    {% if current_user.is_authenticated %}
                    <li class="nav-item">
                        <a class="nav-link {{ 'active' if request.endpoint == 'main.dashboard' }}" 
                           href="{{ url_for('main.dashboard') }}">
                            <i class="bi bi-speedometer2"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {{ 'active' if 'dataset' in request.endpoint }}" 
                           href="{{ url_for('main.list_datasets') }}">
                            <i class="bi bi-database"></i>
                            <span>Datasets</span>
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-tools"></i>
                            <span>Outils</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('nettoyage_auto') }}">
                                <i class="bi bi-magic"></i>
                                Nettoyage Auto
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('analyses') }}">
                                <i class="bi bi-graph-up"></i>
                                Analyses Avancées
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('etl_pipeline') }}">
                                <i class="bi bi-arrow-left-right"></i>
                                Pipeline ETL
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('ml_auto') }}">
                                <i class="bi bi-cpu"></i>
                                ML Automatique
                            </a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('main.upload_file') }}">
                            <i class="bi bi-cloud-upload"></i>
                            <span>Upload</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
                
                <!-- Right Side Navigation -->
                <ul class="navbar-nav">
                    <!-- Theme Toggle -->
                    <li class="nav-item">
                        <button class="theme-toggle me-3" id="theme-toggle" title="Changer le thème">
                            <i class="bi bi-sun-fill" id="theme-icon"></i>
                        </button>
                    </li>
                    
                    {% if current_user.is_authenticated %}
                    <!-- Notifications -->
                    <li class="nav-item dropdown me-2">
                        <a class="nav-link position-relative" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-bell fs-5"></i>
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none;" id="notification-badge">
                                0
                            </span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" style="min-width: 300px;">
                            <li class="dropdown-header">
                                <strong>Notifications</strong>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li class="dropdown-item text-center text-muted py-3">
                                <i class="bi bi-inbox fs-4 d-block mb-2"></i>
                                Aucune notification
                            </li>
                        </ul>
                    </li>
                    
                    <!-- User Menu -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" 
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <div class="user-avatar">
                                {{ current_user.first_name[0] }}{{ current_user.last_name[0] }}
                            </div>
                            <span class="d-none d-md-inline">{{ current_user.get_full_name() }}</span>
                            {% if current_user.is_premium %}
                            <span class="badge bg-warning ms-2">Premium</span>
                            {% endif %}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li class="dropdown-header">
                                <strong>{{ current_user.get_full_name() }}</strong>
                                <small class="text-muted d-block">{{ current_user.email }}</small>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="{{ url_for('profil') }}">
                                <i class="bi bi-person"></i>
                                Mon Profil
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('parametres') }}">
                                <i class="bi bi-gear"></i>
                                Paramètres
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('api_keys') }}">
                                <i class="bi bi-key"></i>
                                Clés API
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('integrations') }}">
                                <i class="bi bi-plug"></i>
                                Intégrations
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">
                                <i class="bi bi-box-arrow-right"></i>
                                Déconnexion
                            </a></li>
                        </ul>
                    </li>
                    {% else %}
                    <!-- Guest Navigation -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('auth.login') }}">
                            <i class="bi bi-box-arrow-in-right"></i>
                            <span>Connexion</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="btn btn-primary ms-2" href="{{ url_for('auth.register') }}">
                            <i class="bi bi-person-plus"></i>
                            <span>Inscription</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- Sidebar (only for authenticated users) -->
    {% if current_user.is_authenticated %}
    <aside class="sidebar" id="sidebar">
        <!-- User Info -->
        <div class="px-3 mb-4">
            <div class="d-flex align-items-center">
                <div class="user-avatar me-3">
                    {{ current_user.first_name[0] }}{{ current_user.last_name[0] }}
                </div>
                <div class="flex-grow-1">
                    <div class="fw-bold">{{ current_user.get_full_name() }}</div>
                    <small class="text-muted">{{ current_user.email }}</small>
                </div>
            </div>
            
            <!-- Quota Bar -->
            <div class="mt-3">
                <div class="d-flex justify-content-between align-items-center mb-1">
                    <small class="text-muted">Stockage utilisé</small>
                    <small class="text-muted">{{ "%.1f"|format(current_user.quota_used) }} / {{ current_user.quota_limit }} MB</small>
                </div>
                <div class="progress" style="height: 4px;">
                    <div class="progress-bar" role="progressbar" 
                         style="width: {{ current_user.get_quota_percentage() }}%"
                         aria-valuenow="{{ current_user.get_quota_percentage() }}" 
                         aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
        </div>
        
        <!-- Navigation Menu -->
        <nav>
            <ul class="sidebar-nav">
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link {{ 'active' if request.endpoint == 'main.dashboard' }}" 
                       href="{{ url_for('main.dashboard') }}">
                        <i class="bi bi-speedometer2"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link {{ 'active' if 'upload' in request.endpoint }}" 
                       href="{{ url_for('main.upload_file') }}">
                        <i class="bi bi-cloud-upload"></i>
                        <span>Upload Dataset</span>
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link {{ 'active' if 'dataset' in request.endpoint }}" 
                       href="{{ url_for('main.list_datasets') }}">
                        <i class="bi bi-database"></i>
                        <span>Mes Datasets</span>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-section">
                <div class="sidebar-section-title">Outils d'analyse</div>
            </div>
            
            <ul class="sidebar-nav">
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link" href="{{ url_for('nettoyage_auto') }}">
                        <i class="bi bi-magic"></i>
                        <span>Nettoyage Auto</span>
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link" href="{{ url_for('analyses') }}">
                        <i class="bi bi-graph-up"></i>
                        <span>Analyses</span>
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link" href="{{ url_for('etl_pipeline') }}">
                        <i class="bi bi-arrow-left-right"></i>
                        <span>Pipeline ETL</span>
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link" href="{{ url_for('ml_auto') }}">
                        <i class="bi bi-cpu"></i>
                        <span>ML Auto</span>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-section">
                <div class="sidebar-section-title">Configuration</div>
            </div>
            
            <ul class="sidebar-nav">
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link" href="{{ url_for('api_keys') }}">
                        <i class="bi bi-key"></i>
                        <span>Clés API</span>
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a class="sidebar-nav-link" href="{{ url_for('parametres') }}">
                        <i class="bi bi-gear"></i>
                        <span>Paramètres</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>
    {% endif %}
    
    <!-- Main Content Area -->
    <main class="main-content {{ 'expanded' if not current_user.is_authenticated }}" id="main-content">
        <!-- Breadcrumb -->
        {% block breadcrumb %}
        {% if current_user.is_authenticated %}
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('main.dashboard') }}">Accueil</a></li>
                {% block breadcrumb_items %}{% endblock %}
            </ol>
        </nav>
        {% endif %}
        {% endblock %}
        
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="alerts-container mb-4">
            {% for category, message in messages %}
            <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show slide-up" role="alert">
                <i class="bi bi-{% if category == 'success' %}check-circle{% elif category == 'error' or category == 'danger' %}exclamation-triangle{% elif category == 'warning' %}exclamation-circle{% else %}info-circle{% endif %} me-2"></i>
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
        
        <!-- Page Header -->
        {% block page_header %}
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1 class="h2 mb-0">{% block page_title %}DataCleaner-Pro{% endblock %}</h1>
                {% block page_description %}{% endblock %}
            </div>
            {% block page_actions %}{% endblock %}
        </div>
        {% endblock %}
        
        <!-- Page Content -->
        <div class="content-area fade-in">
            {% block content %}{% endblock %}
        </div>
    </main>
    
    <!-- Footer -->
    {% if not current_user.is_authenticated %}
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5>DataCleaner-Pro</h5>
                    <p class="mb-3">Plateforme avancée de nettoyage et d'analyse de données avec intelligence artificielle intégrée.</p>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-decoration-none">
                            <i class="bi bi-github fs-5"></i>
                        </a>
                        <a href="#" class="text-decoration-none">
                            <i class="bi bi-twitter fs-5"></i>
                        </a>
                        <a href="#" class="text-decoration-none">
                            <i class="bi bi-linkedin fs-5"></i>
                        </a>
                    </div>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>Produit</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#">Fonctionnalités</a></li>
                        <li class="mb-2"><a href="#">Tarifs</a></li>
                        <li class="mb-2"><a href="#">Documentation</a></li>
                        <li class="mb-2"><a href="#">API</a></li>
                    </ul>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>Entreprise</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#">À propos</a></li>
                        <li class="mb-2"><a href="#">Blog</a></li>
                        <li class="mb-2"><a href="#">Carrières</a></li>
                        <li class="mb-2"><a href="#">Contact</a></li>
                    </ul>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>Support</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#">Centre d'aide</a></li>
                        <li class="mb-2"><a href="#">Communauté</a></li>
                        <li class="mb-2"><a href="#">Tutoriels</a></li>
                        <li class="mb-2"><a href="#">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>Légal</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#">Confidentialité</a></li>
                        <li class="mb-2"><a href="#">Conditions</a></li>
                        <li class="mb-2"><a href="#">Sécurité</a></li>
                        <li class="mb-2"><a href="#">Cookies</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; {{ moment().format('YYYY') }} DataCleaner-Pro. Tous droits réservés.</p>
            </div>
        </div>
    </footer>
    {% endif %}
    
    <!-- JavaScript Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables.net@1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables.net-bs5@1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/notyf@3.10.0/notyf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Global DataCleaner-Pro Application Object
        window.DataCleanerPro = {
            // Configuration
            config: {
                apiUrl: '/api/v1',
                wsUrl: `${window.location.protocol === 'https:' ? 'wss:' : 'ws:'}//${window.location.host}/ws`,
                notifications: true,
                theme: localStorage.getItem('theme') || 'light',
                sidebar: {
                    collapsed: localStorage.getItem('sidebar-collapsed') === 'true'
                }
            },
            
            // Utility functions
            utils: {
                // Format file size
                formatFileSize: function(bytes) {
                    if (bytes === 0) return '0 B';
                    const k = 1024;
                    const sizes = ['B', 'KB', 'MB', 'GB'];
                    const i = Math.floor(Math.log(bytes) / Math.log(k));
                    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
                },
                
                // Format number with separators
                formatNumber: function(num) {
                    return new Intl.NumberFormat('fr-FR').format(num);
                },
                
                // Debounce function
                debounce: function(func, wait) {
                    let timeout;
                    return function executedFunction(...args) {
                        const later = () => {
                            clearTimeout(timeout);
                            func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                },
                
                // Show loading state
                showLoading: function(element) {
                    if (typeof element === 'string') {
                        element = document.querySelector(element);
                    }
                    if (element) {
                        element.classList.add('loading');
                        const spinner = element.querySelector('.spinner-border');
                        if (spinner) spinner.style.display = 'inline-block';
                    }
                },
                
                // Hide loading state
                hideLoading: function(element) {
                    if (typeof element === 'string') {
                        element = document.querySelector(element);
                    }
                    if (element) {
                        element.classList.remove('loading');
                        const spinner = element.querySelector('.spinner-border');
                        if (spinner) spinner.style.display = 'none';
                    }
                },
                
                // Copy to clipboard
                copyToClipboard: function(text) {
                    return navigator.clipboard.writeText(text).then(() => {
                        this.showNotification('Copié dans le presse-papiers', 'success');
                    }).catch(() => {
                        this.showNotification('Erreur lors de la copie', 'error');
                    });
                },
                
                // Show notification
                showNotification: function(message, type = 'info') {
                    if (window.notyf) {
                        if (type === 'success') {
                            window.notyf.success(message);
                        } else if (type === 'error') {
                            window.notyf.error(message);
                        } else {
                            window.notyf.open({
                                type: type,
                                message: message
                            });
                        }
                    }
                }
            },
            
            // API functions
            api: {
                // Generic API call
                call: function(endpoint, options = {}) {
                    const defaults = {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Requested-With': 'XMLHttpRequest'
                        }
                    };
                    
                    const config = Object.assign(defaults, options);
                    
                    return fetch(`${DataCleanerPro.config.apiUrl}${endpoint}`, config)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error(`HTTP error! status: ${response.status}`);
                            }
                            return response.json();
                        });
                },
                
                // Get datasets
                getDatasets: function() {
                    return this.call('/datasets');
                },
                
                // Get dataset details
                getDataset: function(id) {
                    return this.call(`/datasets/${id}`);
                },
                
                // Start cleaning job
                startCleaning: function(datasetId, config) {
                    return this.call('/cleaning/start', {
                        method: 'POST',
                        body: JSON.stringify({
                            dataset_id: datasetId,
                            config: config
                        })
                    });
                },
                
                // Start analysis
                startAnalysis: function(datasetId, config) {
                    return this.call('/analysis/start', {
                        method: 'POST',
                        body: JSON.stringify({
                            dataset_id: datasetId,
                            config: config
                        })
                    });
                }
            },
            
            // Component initializers
            components: {
                // Initialize DataTables
                initDataTables: function() {
                    $('.data-table').each(function() {
                        const table = $(this);
                        const config = {
                            responsive: true,
                            pageLength: 25,
                            language: {
                                url: 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/fr-FR.json'
                            },
                            dom: '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>' +
                                 '<"row"<"col-sm-12"tr>>' +
                                 '<"row"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7"p>>',
                            ...JSON.parse(table.attr('data-table-config') || '{}')
                        };
                        
                        table.DataTable(config);
                    });
                },
                
                // Initialize Select2
                initSelect2: function() {
                    $('.select2').each(function() {
                        const select = $(this);
                        const config = {
                            theme: 'bootstrap-5',
                            width: '100%',
                            language: 'fr',
                            ...JSON.parse(select.attr('data-select2-config') || '{}')
                        };
                        
                        select.select2(config);
                    });
                },
                
                // Initialize date pickers
                initDatePickers: function() {
                    $('.date-picker').each(function() {
                        const picker = this;
                        const config = {
                            locale: 'fr',
                            dateFormat: 'Y-m-d',
                            ...JSON.parse(picker.getAttribute('data-picker-config') || '{}')
                        };
                        
                        flatpickr(picker, config);
                    });
                },
                
                // Initialize tooltips
                initTooltips: function() {
                    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                    tooltipTriggerList.map(function (tooltipTriggerEl) {
                        return new bootstrap.Tooltip(tooltipTriggerEl);
                    });
                },
                
                // Initialize popovers
                initPopovers: function() {
                    const popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
                    popoverTriggerList.map(function (popoverTriggerEl) {
                        return new bootstrap.Popover(popoverTriggerEl);
                    });
                },
                
                // Initialize file upload areas
                initFileUploads: function() {
                    $('.file-upload-area').each(function() {
                        const area = this;
                        const input = area.querySelector('input[type="file"]');
                        
                        if (!input) return;
                        
                        // Click to upload
                        area.addEventListener('click', () => input.click());
                        
                        // Drag and drop
                        area.addEventListener('dragover', (e) => {
                            e.preventDefault();
                            area.classList.add('dragover');
                        });
                        
                        area.addEventListener('dragleave', () => {
                            area.classList.remove('dragover');
                        });
                        
                        area.addEventListener('drop', (e) => {
                            e.preventDefault();
                            area.classList.remove('dragover');
                            
                            const files = e.dataTransfer.files;
                            if (files.length > 0) {
                                input.files = files;
                                input.dispatchEvent(new Event('change'));
                            }
                        });
                        
                        // File selection feedback
                        input.addEventListener('change', function() {
                            const fileInfo = area.querySelector('.file-info');
                            if (this.files.length > 0) {
                                const file = this.files[0];
                                if (fileInfo) {
                                    fileInfo.innerHTML = `
                                        <strong>${file.name}</strong><br>
                                        <small class="text-muted">${DataCleanerPro.utils.formatFileSize(file.size)}</small>
                                    `;
                                }
                            }
                        });
                    });
                }
            },
            
            // Theme management
            theme: {
                // Set theme
                set: function(theme) {
                    document.documentElement.setAttribute('data-bs-theme', theme);
                    localStorage.setItem('theme', theme);
                    DataCleanerPro.config.theme = theme;
                    
                    // Update theme toggle icon
                    const icon = document.getElementById('theme-icon');
                    if (icon) {
                        icon.className = theme === 'dark' ? 'bi bi-moon-fill' : 'bi bi-sun-fill';
                    }
                },
                
                // Toggle theme
                toggle: function() {
                    const newTheme = DataCleanerPro.config.theme === 'light' ? 'dark' : 'light';
                    this.set(newTheme);
                },
                
                // Initialize theme
                init: function() {
                    this.set(DataCleanerPro.config.theme);
                    
                    // Theme toggle button
                    const themeToggle = document.getElementById('theme-toggle');
                    if (themeToggle) {
                        themeToggle.addEventListener('click', () => this.toggle());
                    }
                }
            },
            
            // Sidebar management
            sidebar: {
                // Toggle sidebar
                toggle: function() {
                    const sidebar = document.getElementById('sidebar');
                    const mainContent = document.querySelector('.main-content');
                    
                    if (sidebar && mainContent) {
                        const isCollapsed = sidebar.classList.toggle('collapsed');
                        mainContent.classList.toggle('expanded', isCollapsed);
                        
                        localStorage.setItem('sidebar-collapsed', isCollapsed);
                        DataCleanerPro.config.sidebar.collapsed = isCollapsed;
                    }
                },
                
                // Initialize sidebar
                init: function() {
                    const sidebar = document.getElementById('sidebar');
                    const mainContent = document.querySelector('.main-content');
                    
                    if (sidebar && mainContent && DataCleanerPro.config.sidebar.collapsed) {
                        sidebar.classList.add('collapsed');
                        mainContent.classList.add('expanded');
                    }
                    
                    // Sidebar toggle on mobile
                    const sidebarToggle = document.querySelector('[data-sidebar-toggle]');
                    if (sidebarToggle) {
                        sidebarToggle.addEventListener('click', () => this.toggle());
                    }
                }
            },
            
            // Progress tracking
            progress: {
                // Show progress bar
                show: function() {
                    if (window.NProgress) {
                        NProgress.start();
                    }
                },
                
                // Hide progress bar
                hide: function() {
                    if (window.NProgress) {
                        NProgress.done();
                    }
                },
                
                // Set progress
                set: function(value) {
                    if (window.NProgress) {
                        NProgress.set(value);
                    }
                }
            },
            
            // Initialize the application
            init: function() {
                // Initialize notifications
                if (typeof Notyf !== 'undefined') {
                    window.notyf = new Notyf({
                        duration: 4000,
                        position: { x: 'right', y: 'top' },
                        types: [
                            {
                                type: 'info',
                                background: 'var(--dc-info)',
                                icon: { className: 'bi bi-info-circle', tagName: 'i' }
                            }
                        ]
                    });
                }
                
                // Initialize theme
                this.theme.init();
                
                // Initialize sidebar
                this.sidebar.init();
                
                // Initialize components
                this.components.initTooltips();
                this.components.initPopovers();
                this.components.initDataTables();
                this.components.initSelect2();
                this.components.initDatePickers();
                this.components.initFileUploads();
                
                // Global AJAX setup
                $(document).ajaxStart(() => this.progress.show());
                $(document).ajaxStop(() => this.progress.hide());
                
                // CSRF token setup
                const csrfToken = document.querySelector('meta[name=csrf-token]');
                if (csrfToken) {
                    $.ajaxSetup({
                        beforeSend: function(xhr, settings) {
                            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                                xhr.setRequestHeader("X-CSRFToken", csrfToken.content);
                            }
                        }
                    });
                }
                
                // Auto-dismiss alerts
                setTimeout(() => {
                    $('.alert:not(.alert-permanent)').fadeOut();
                }, 5000);
                
                // Confirm dialogs
                $('[data-confirm]').on('click', function(e) {
                    const message = $(this).data('confirm');
                    if (!confirm(message)) {
                        e.preventDefault();
                        return false;
                    }
                });
                
                // Auto scroll to top on page change
                if (window.history && window.history.pushState) {
                    $(window).on('popstate', () => {
                        window.scrollTo(0, 0);
                    });
                }
                
                console.log('DataCleaner-Pro initialized successfully');
            }
        };
        
        // Initialize when DOM is ready
        $(document).ready(function() {
            DataCleanerPro.init();
        });
        
        // Additional page-specific initialization
        {% block extra_js_init %}{% endblock %}
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>